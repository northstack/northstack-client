FROM northstack:latest

RUN apk add \
        curl \
        jq \
        rsync \
        docker \
        bash \
        py-pip \
        mysql-client \
        shadow \
        sudo \
        gcc \
        python-dev \
        musl-dev \
        libffi-dev \
    && curl -O https://raw.githubusercontent.com/wp-cli/builds/gh-pages/phar/wp-cli.phar \
        && chmod +x wp-cli.phar \
        && mv wp-cli.phar /usr/local/bin/wp \
    && pip install --upgrade pip \
    && pip install docker-compose \
    && docker-php-ext-install \
        mysqli \
        pdo_mysql

ARG NORTHSTACK_USER
ARG NORTHSTACK_UID
ARG NORTHSTACK_GROUP
ARG NORTHSTACK_GID
ARG DOCKER_GROUP
ARG DOCKER_GID

COPY entrypoint-test.sh /entrypoint.sh
ENTRYPOINT ["/entrypoint.sh"]
